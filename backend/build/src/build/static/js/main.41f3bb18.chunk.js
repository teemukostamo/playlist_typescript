(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{280:function(e,t,a){e.exports=a.p+"static/media/logo.ca9e42db.png"},321:function(e,t,a){e.exports=a(564)},347:function(e,t,a){},564:function(e,t,a){"use strict";a.r(t);for(var r=a(0),n=a.n(r),l=a(47),c=a.n(l),o=a(23),u=(a(329),a(29)),i=a(75),s=a(15),m=a.n(s),d=a(578),p=a(205),E=(a(347),a(585)),f=a(310),b=a(280),v=a.n(b),g=function(e){e.currentUser;return n.a.createElement("div",{style:{marginBottom:"1.5rem"}},n.a.createElement(E.a,{pointing:!0,stackable:!0,inverted:!0},n.a.createElement(E.a.Item,{link:!0},n.a.createElement(u.b,{to:"/"},n.a.createElement(f.a,{alt:"logo",src:v.a,size:"mini"}))),n.a.createElement(E.a.Item,{link:!0},n.a.createElement(u.b,{to:"/reports"},n.a.createElement("h4",null,"REPORTS"))),n.a.createElement(E.a.Item,{link:!0},n.a.createElement(u.b,{to:"/top100"},n.a.createElement("h4",null,"TOP 100"))),n.a.createElement(E.a.Item,{link:!0},n.a.createElement(u.b,{to:"/search"},n.a.createElement("h4",null,"SEARCH"))),n.a.createElement(E.a.Item,{link:!0},n.a.createElement(u.b,{to:"/transfer"},n.a.createElement("h4",null,"TRANSFER FILES"))),n.a.createElement(E.a.Item,{link:!0},n.a.createElement(u.b,{to:"/programs"},n.a.createElement("h4",null,"PROGRAMS"))),n.a.createElement(E.a.Item,{link:!0},n.a.createElement(u.b,{to:"/users"},n.a.createElement("h4",null,"USERS"))),n.a.createElement(E.a.Item,{position:"right"}),n.a.createElement(E.a.Item,null)))},h=function(){var e,t=Object(o.c)((function(e){return e.login}));switch(null===(e=t.currentUser)||void 0===e?void 0:e.level){case 1:case 2:case 3:return n.a.createElement(g,{currentUser:t.currentUser});default:return null}},O=function(){return n.a.createElement("div",{style:{marginTop:"5rem",marginBottom:"2rem",textAlign:"center"}},n.a.createElement("br",null),n.a.createElement("em",null," ","\xa9 ",(new Date).getFullYear()," ",n.a.createElement("a",{href:"https://www.teemukostamo.com",target:"_blank",rel:"noopener noreferrer"}," ","Teemu Kostamo"," ")," "))},y=a(13),_=a(31),T=a(83),w=a(4),A=a.n(w),C=a(11),R="/api/programs",k=null,j={getAllActive:function(){var e=Object(C.a)(A.a.mark((function e(){var t,a;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={headers:{Authorization:k}},e.next=3,m.a.get("".concat(R,"/active"),t);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),getAll:function(){var e=Object(C.a)(A.a.mark((function e(){var t,a;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={headers:{Authorization:k}},e.next=3,m.a.get("".concat(R,"/all"),t);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),getOne:function(){var e=Object(C.a)(A.a.mark((function e(t){var a,r;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:{Authorization:k}},e.next=3,m.a.get("".concat(R,"/getone/").concat(t),a);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),createProgram:function(){var e=Object(C.a)(A.a.mark((function e(t){var a,r;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:{Authorization:k}},e.next=3,m.a.post(R,t,a);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),updateProgram:function(){var e=Object(C.a)(A.a.mark((function e(t){var a,r;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:{Authorization:k}},e.next=3,m.a.put("".concat(R,"/update"),t,a);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),mergePrograms:function(){var e=Object(C.a)(A.a.mark((function e(t){var a,r;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:{Authorization:k}},e.next=3,m.a.put("".concat(R,"/merge"),t,a);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),setToken:function(e){k="bearer ".concat(e)}},S=a(586),L=a(579),D=a(583),x=a(156),I=a(588),N=a(587),P=a(14),U=a(581),G=function(e){var t=e.name,a=e.label,r=e.options;return n.a.createElement(U.a.Field,null,n.a.createElement("label",null,a),n.a.createElement(P.b,{as:"select",name:t,className:"ui dropdown"},r.map((function(e){return n.a.createElement("option",{key:e.value,value:e.value},e.label||e.value)}))))},M=function(e){var t=e.field,a=e.label,r=e.placeholder;return n.a.createElement(U.a.Field,null,n.a.createElement("label",null,a),n.a.createElement(P.b,Object.assign({placeholder:r},t,{type:"text"})),n.a.createElement("div",{style:{color:"red"}},n.a.createElement(P.a,{name:t.name})))},F=function(e){var t=e.field,a=e.label,r=e.placeholder;return n.a.createElement(U.a.Field,{required:!0},n.a.createElement("label",null,a),n.a.createElement(P.b,Object.assign({placeholder:r},t,{type:"text"})),n.a.createElement("div",{style:{color:"red"}},n.a.createElement(P.a,{name:t.name})))},Y=function(e){var t=e.field,a=e.label,r=e.placeholder;return n.a.createElement(U.a.Field,null,n.a.createElement("label",null,a),n.a.createElement(P.b,Object.assign({placeholder:r},t,{type:"password"})),n.a.createElement("div",{style:{color:"red"}},n.a.createElement(P.a,{name:t.name})))},B=function(e){var t=e.field,a=e.label,r=e.placeholder;return n.a.createElement(U.a.Field,{required:!0},n.a.createElement("label",null,a),n.a.createElement(P.b,Object.assign({placeholder:r},t,{type:"password"})),n.a.createElement("div",{style:{color:"red"}},n.a.createElement(P.a,{name:t.name})))},V=[{value:1,label:"Visible"},{value:0,label:"Invisible"}],z=[{value:1,label:"Visible"},{value:0,label:"Invisible"}],H=function(e){var t,a=e.onSubmit,r=e.onCancel,l=e.login,c=e.program;return n.a.createElement(P.d,{initialValues:{id:c.id,name:c.name,identifier:c.identifier,display:c.display||1,site:c.site||1,user_id:null===(t=l.currentUser)||void 0===t?void 0:t.id},onSubmit:a,validate:function(e){var t={};return e.name||(t.name="Field is required"),console.log(e.display),console.log(e.site),t}},(function(e){var t=e.isValid;return n.a.createElement(P.c,{className:"form ui"},n.a.createElement(P.b,{label:"Name",placeholder:"Name",name:"name",component:M}),n.a.createElement(P.b,{label:"Identifier",placeholder:"Identifier",name:"identifier",type:"password",component:M}),n.a.createElement(G,{label:"Display",name:"display",options:V}),n.a.createElement(G,{label:"Display on site",name:"site",options:z}),n.a.createElement(N.a,null,n.a.createElement(N.a.Column,{floated:"left",width:5},n.a.createElement(p.a,{type:"button",onClick:r,color:"red"},"Cancel")),n.a.createElement(N.a.Column,{floated:"right",width:5},n.a.createElement(p.a,{type:"submit",floated:"right",color:"green",disabled:!t},"Save changes"))))}))},K=function(e){var t=e.modalOpen,a=e.onClose,r=e.onSubmit,l=e.error,c=e.program,o=e.login;return n.a.createElement(x.a,{open:t,onClose:a,centered:!1,closeIcon:!0},n.a.createElement(x.a.Header,null,"Edit info of program ",c.name),n.a.createElement(x.a.Content,null,l&&n.a.createElement(I.a,{inverted:!0,color:"red"},"Error: ".concat(l)),n.a.createElement(H,{program:c,login:o,onSubmit:r,onCancel:a})))},q=a(589),J=function(e,t){var a={message:e,type:t};return function(){var e=Object(C.a)(A.a.mark((function e(t){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t({type:"SET_NOTIFICATION",data:a}),setTimeout((function(){t({type:"CLEAR_NOTIFICATION"})}),3e3);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},W=function(e){var t=e.onSubmit,a=e.onCancel,r=e.selectOptions;return n.a.createElement(P.d,{initialValues:{programToMerge:r[0].value},onSubmit:t},(function(e){var t=e.dirty;return n.a.createElement(P.c,{className:"form ui"},n.a.createElement("span",{style:{color:"red"}},n.a.createElement(G,{label:"",name:"programToMerge",options:r})),n.a.createElement(N.a,null,n.a.createElement(N.a.Column,{style:{marginTop:"1rem"},floated:"left",width:5},n.a.createElement(p.a,{type:"button",onClick:a,color:"red"},"Cancel")),n.a.createElement(N.a.Column,{floated:"right",width:5},n.a.createElement(p.a,{type:"submit",floated:"right",color:"green",disabled:!t},"Merge"))))}))},Q=function(e){var t=e.program_id,a=e.program_name,l=Object(o.b)(),c=Object(o.c)((function(e){return e.program})),u=Object(r.useState)(!1),i=Object(_.a)(u,2),s=i[0],m=i[1],d=function(){m(!0)},p=function(){m(!1)};if(!s)return n.a.createElement("button",{type:"button",className:"link-btn",onClick:d},t);var E=c.allPrograms.map((function(e){return{key:e.id,label:"".concat(e.id," - ").concat(e.name),value:e.id}}));return n.a.createElement(x.a,{open:s,closeIcon:!0,onClose:p,trigger:n.a.createElement("button",{type:"button",className:"link-btn",onClick:d},t)},n.a.createElement(q.a,null,"Merge ",t," - ",a," with:"),n.a.createElement(x.a.Content,null,n.a.createElement(W,{onSubmit:function(e){console.log(Number(e.programToMerge));var a={type:"program",merge:Number(e.programToMerge),mergeTo:t};console.log(a),l(function(e){return function(){var t=Object(C.a)(A.a.mark((function t(a){var r;return A.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a({type:"SET_LOADING"}),t.next=4,j.mergePrograms(e);case 4:return t.next=6,j.getAll();case 6:r=t.sent,a({type:"GET_ALL_PROGRAMS",data:r}),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),console.log("error merging two programs programActions.mergePrograms",t.t0);case 13:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(e){return t.apply(this,arguments)}}()}(a)),l(J("Ohjelma #".concat(a.merge," yhdistetty!"),"success")),p()},onCancel:p,selectOptions:E})))},X=function(e){var t,a=e.program,l=Object(o.c)((function(e){return e.login})),c=Object(o.b)(),u=Object(r.useState)(!1),i=Object(_.a)(u,2),s=i[0],m=i[1],d=Object(r.useState)(),p=Object(_.a)(d,2),E=p[0],f=p[1];1===a.display&&(t="active-program");var b=function(){m(!1),f(void 0)};return n.a.createElement(D.a.Row,{className:t},n.a.createElement(D.a.Cell,null,n.a.createElement(Q,{program_id:a.id,program_name:a.name})),n.a.createElement(D.a.Cell,null,n.a.createElement(K,{program:a,login:l,modalOpen:s,onSubmit:function(e){try{console.log(e),c((t=e,function(){var e=Object(C.a)(A.a.mark((function e(a){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a({type:"SET_LOADING"}),e.next=4,j.updateProgram(t);case 4:a({type:"UPDATE_PROGRAM",data:t}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log("error updating program",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}())),c(J("".concat(e.name," updated!"),"success")),b()}catch(a){console.error(a.response.data),f(a.response.data.error)}var t},error:E,onClose:b}),n.a.createElement("button",{style:{border:"none",cursor:"pointer",color:"blue"},onClick:function(){return m(!0)}},a.name)),n.a.createElement(D.a.Cell,null,a.identifier))},Z=function(e){var t,a,r=e.login,l=e.program;return null===l.allPrograms||!0===l.loading?n.a.createElement(d.a,null,n.a.createElement(S.a,{active:!0,inverted:!0},n.a.createElement(L.a,{size:"medium"},"Loading programs..."))):2===(null===(t=r.currentUser)||void 0===t?void 0:t.level)||3===(null===(a=r.currentUser)||void 0===a?void 0:a.level)?n.a.createElement(d.a,null,n.a.createElement("div",{style:{marginTop:"1rem",marginBottom:"1rem"}},n.a.createElement("h3",{style:{display:"inline"}},"Programs")),n.a.createElement(D.a,{striped:!0},n.a.createElement(D.a.Header,null,n.a.createElement(D.a.Row,null,n.a.createElement(D.a.Cell,null,"ID"),n.a.createElement(D.a.Cell,null,"Program name"),n.a.createElement(D.a.Cell,null,"Program identifier"))),n.a.createElement(D.a.Body,null,l.allPrograms.map((function(e){return n.a.createElement(X,{program:e,key:e.id})}))))):null},$=[{value:1,label:"Visible"},{value:0,label:"Invisible"}],ee=[{value:1,label:"Visible"},{value:0,label:"Invisible"}],te=function(e){var t,a=e.onSubmit,r=e.onCancel,l=e.login;return n.a.createElement(P.d,{initialValues:{name:"",identifier:"",display:1,site:1,user_id:null===(t=l.currentUser)||void 0===t?void 0:t.id},onSubmit:a,validate:function(e){var t={};return e.name||(t.name="Field is required"),console.log(e.display),console.log(e.site),t}},(function(e){var t=e.isValid,a=e.dirty;return n.a.createElement(P.c,{className:"form ui"},n.a.createElement(P.b,{label:"Name",placeholder:"Name",name:"name",component:F}),n.a.createElement(P.b,{label:"Identifier",placeholder:"Identifier",name:"identifier",type:"password",component:M}),n.a.createElement(G,{label:"Display",name:"display",options:$}),n.a.createElement(G,{label:"Display on site",name:"site",options:ee}),n.a.createElement(N.a,null,n.a.createElement(N.a.Column,{floated:"left",width:5},n.a.createElement(p.a,{type:"button",onClick:r,color:"red"},"Cancel")),n.a.createElement(N.a.Column,{floated:"right",width:5},n.a.createElement(p.a,{type:"submit",floated:"right",color:"green",disabled:!a||!t},"Add"))))}))},ae=function(e){var t=e.modalOpen,a=e.onClose,r=e.onSubmit,l=e.error,c=e.login;return n.a.createElement(x.a,{open:t,onClose:a,centered:!1,closeIcon:!0},n.a.createElement(x.a.Header,null,"Add a new program"),n.a.createElement(x.a.Content,null,l&&n.a.createElement(I.a,{inverted:!0,color:"red"},"Error: ".concat(l)),n.a.createElement(te,{onSubmit:r,onCancel:a,login:c})))},re=function(){var e=Object(o.c)((function(e){return e.program})),t=Object(o.c)((function(e){return e.login})),a=Object(o.b)();Object(r.useEffect)((function(){a(function(){var e=Object(C.a)(A.a.mark((function e(t){var a;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t({type:"SET_LOADING"}),e.next=4,j.getAll();case 4:a=e.sent,t({type:"GET_ALL_PROGRAMS",data:a}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log("error getting all programs programActions.getAllPrograms",e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}())}),[]);var l=n.a.useState(!1),c=Object(_.a)(l,2),u=c[0],i=c[1];console.log(u);var s=n.a.useState(),m=Object(_.a)(s,2),E=m[0],f=m[1],b=function(){i(!1),f(void 0)};return n.a.createElement(d.a,null,n.a.createElement(p.a,{floated:"right",color:"green",style:{marginBottom:"0.5rem"},onClick:function(){return i(!0)}},n.a.createElement(T.a,{name:"add"}),"Create a new program"),n.a.createElement(ae,{modalOpen:u,onSubmit:function(e){try{var t=Object(y.a)({},e,{display:Number(e.display),site:Number(e.site)});console.log(t),a(function(e){return function(){var t=Object(C.a)(A.a.mark((function t(a){var r;return A.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a({type:"SET_LOADING"}),t.next=4,j.createProgram(e);case 4:r=t.sent,a({type:"CREATE_NEW_PROGRAM",data:r}),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.log("error creating new program",t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}()}(t)),console.log("adding program",t),b()}catch(r){console.error(r.response.data),f(r.response.data.error)}},error:E,onClose:b,login:t}),n.a.createElement(Z,{program:e,login:t}))},ne=a(591),le=a(43),ce=a.n(le),oe=[{key:"01",label:"Tammikuu",value:"01"},{key:"02",label:"Helmikuu",value:"02"},{key:"03",label:"Maaliskuu",value:"03"},{key:"04",label:"Huhtikuu",value:"04"},{key:"05",label:"Toukokuu",value:"05"},{key:"06",label:"Kes\xe4kuu",value:"06"},{key:"07",label:"Hein\xe4kuu",value:"07"},{key:"08",label:"Elokuu",value:"08"},{key:"09",label:"Syyskuu",value:"09"},{key:"10",label:"Lokakuu",value:"10"},{key:"11",label:"Marraskuu",value:"11"},{key:"12",label:"Joulukuu",value:"12"}],ue=(new Date).getFullYear()+1,ie=[],se=2001;se<=ue;se++)ie.push(se);var me,de=ie.map((function(e){return{key:e.toString(),label:e.toString(),value:e.toString()}})),pe=de=de.reverse(),Ee=function(e){var t=e.onSubmit;return console.log(pe),n.a.createElement(P.d,{initialValues:{reportYear:"2020",reportMonth:"01"},onSubmit:t},(function(){return n.a.createElement(P.c,{className:"form ui"},n.a.createElement(N.a,null,n.a.createElement(N.a.Column,{width:4},n.a.createElement(G,{label:"Select month",name:"reportMonth",options:oe})),n.a.createElement(N.a.Column,{width:4},n.a.createElement(G,{label:"Select month",name:"reportYear",options:pe})),n.a.createElement(N.a.Column,{width:4},n.a.createElement(p.a,{type:"submit",floated:"right",color:"green"},"Get reports"))))}))},fe=a(580),be=a(303),ve=a.n(be),ge=null,he=function(){var e=Object(C.a)(A.a.mark((function e(t){var a,r;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:{Authorization:ge}},e.next=3,m.a.get("".concat("/api/reportslist","/date/").concat(t),a);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Oe=function(){var e=Object(C.a)(A.a.mark((function e(t,a){var r,n;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={headers:{Authorization:ge}},e.next=3,m.a.get("".concat("/api/reportslist","/all?date=").concat(t,"&user=").concat(a),r);case 3:return n=e.sent,e.abrupt("return",n.data);case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),ye=function(){var e=Object(C.a)(A.a.mark((function e(t){var a,r;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:{Authorization:ge}},e.next=3,m.a.get("".concat("/api/reportslist","/user/").concat(t),a);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_e=function(){var e=Object(C.a)(A.a.mark((function e(){var t,a;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={headers:{Authorization:ge}},e.next=3,m.a.get("/api/reporttransfer",t);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Te={setToken:function(e){ge="bearer ".concat(e)},deleteReport:function(){var e=Object(C.a)(A.a.mark((function e(t){var a,r;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:{Authorization:ge}},e.next=3,m.a.put("".concat("/api/reportslist","/").concat(t),{},a);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),getAllByDate:he,getAllByDateByUser:Oe,getAllInProgress:ye,getAllTransfers:_e,generateReportDownload:function(){var e=Object(C.a)(A.a.mark((function e(t){var a,r;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a={headers:{Authorization:ge,responseType:"blob"}},e.next=4,m.a.post("/api/reporttransfer",t,a);case 4:return r=e.sent,e.abrupt("return",r.data);case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),downloadReport:function(){var e=Object(C.a)(A.a.mark((function e(t){var a,r;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a={headers:{Authorization:ge,responseType:"blob"}},e.next=4,m.a.get("/api/reporttransfer/".concat(t),a);case 4:r=e.sent,ve()(r.data,t),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}()},we=function(e){return function(){var t=Object(C.a)(A.a.mark((function t(a){var r;return A.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a({type:"SET_LOADING"}),a({type:"CLEAR_CURRENT_REPORT"}),t.next=5,Te.getAllByDate(e);case 5:r=t.sent,a({type:"GET_ALL_REPORTS_BY_DATE",data:r,date:e}),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),console.log("reportListActions getAllReportsByDate error",t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}()},Ae=function(e,t){return function(){var a=Object(C.a)(A.a.mark((function a(r){var n;return A.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,r({type:"SET_LOADING"}),r({type:"CLEAR_CURRENT_REPORT"}),a.next=5,Te.getAllByDateByUser(e,t);case 5:n=a.sent,r({type:"GET_ALL_REPORTS_BY_DATE",data:n,date:e}),a.next=12;break;case 9:a.prev=9,a.t0=a.catch(0),console.log("reportListActions getAllReportsByDateByUser error",a.t0);case 12:case"end":return a.stop()}}),a,null,[[0,9]])})));return function(e){return a.apply(this,arguments)}}()},Ce=function(e){var t,a,l=e.loginLevel,c=e.report,i=Object(o.b)(),s=Object(r.useState)(!1),m=Object(_.a)(s,2),d=m[0],p=m[1];if(1===c.status)t="Ready";else if(0===c.status)t="In progress";else if(9===c.status)return t="Deleted",null;return 1===c.rerun&&(a="rerun"),1===l&&1===c.rerun?null:n.a.createElement(n.a.Fragment,null,n.a.createElement(D.a.Row,{className:a},n.a.createElement(ne.a,{as:D.a.Cell,minWidth:768},c.program_no),n.a.createElement(D.a.Cell,null,n.a.createElement(u.b,{className:a,to:"reports/".concat(c.id)},c.name)),n.a.createElement(D.a.Cell,null,ce()(c.program_date).format("DD.MM.YYYY")),n.a.createElement(D.a.Cell,null,c.program_start_time.slice(0,-3)," -"," ",c.program_end_time.slice(0,-3)),n.a.createElement(D.a.Cell,null,t),n.a.createElement(D.a.Cell,null,n.a.createElement(T.a,{style:{color:"red"},name:"delete",onClick:function(){return p(!0)}}),n.a.createElement(fe.a,{content:"Haluatko varmasti poistaa raportin ".concat(c.name," ").concat(c.program_date),open:d,onCancel:function(){p(!1)},onConfirm:function(){var e;p(!1),i((e=c.id,function(){var t=Object(C.a)(A.a.mark((function t(a){return A.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a({type:"SET_LOADING"}),t.next=4,Te.deleteReport(e);case 4:a({type:"DELETE_REPORT",data:e}),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}())),i(J("".concat(c.name," ").concat(c.program_date," poistettu!"),"success"))}}))))},Re=function(){var e=Object(o.c)((function(e){return e.login})),t=Object(o.c)((function(e){return e.reportList}));console.log(t);var a=Object(o.b)();Object(r.useEffect)((function(){var r;1===(null===(r=e.currentUser)||void 0===r?void 0:r.level)?null===t.reportListDate?a(Ae(ce()().format("YYYY-MM"),e.currentUser.id)):a(Ae(t.reportListDate,e.currentUser.id)):null===t.reportListDate?a(we(ce()().format("YYYY-MM"))):a(we(t.reportListDate))}),[]);var l,c=function(t){var r;console.log(t);var n="".concat(t.reportYear,"-").concat(t.reportMonth);1===(null===(r=e.currentUser)||void 0===r?void 0:r.level)?a(Ae(n,e.currentUser.id)):a(we(n))};if(null===t.reportList||t.loading)return n.a.createElement(S.a,{active:!0},n.a.createElement(L.a,{content:"Ladataan..."}));if(0===t.reportList.length)return n.a.createElement(d.a,null,n.a.createElement("h2",null,"No reports in the selected time period"),n.a.createElement(Ee,{onSubmit:c}));l=null===t.reportListDate?ce()().format("MMMM YYYY"):ce()(t.reportListDate).format("MMMM YYYY");var u=t.reportList;return u=0===Number(t.filterByText)?u:u=u.filter((function(e){return e.name.toLowerCase().includes(t.filterByText.toLowerCase())})),u=null===t.filterUserValue?u:u=u.filter((function(e){return e.user_id===t.filterUserValue})),u=null===t.filterStatusValue?u:u=u.filter((function(e){return e.status===t.filterStatusValue})),n.a.createElement(d.a,null,n.a.createElement("h3",null,"Reports ",l),n.a.createElement(Ee,{onSubmit:c}),n.a.createElement(D.a,{striped:!0},n.a.createElement(D.a.Header,null,n.a.createElement(D.a.Row,null,n.a.createElement(ne.a,{as:D.a.Cell,minWidth:768},"Program number"),n.a.createElement(D.a.Cell,null,"Program name"),n.a.createElement(D.a.Cell,null,"Date"),n.a.createElement(D.a.Cell,null,"Time"),n.a.createElement(D.a.Cell,null,"Status"),n.a.createElement(D.a.Cell,null))),n.a.createElement(D.a.Body,null,u.map((function(t){var a;return n.a.createElement(Ce,{key:t.id,report:t,loginLevel:null===(a=e.currentUser)||void 0===a?void 0:a.level})})))))},ke=null,je=function(){var e=Object(C.a)(A.a.mark((function e(t){var a,r;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:{Authorization:ke}},e.next=3,m.a.get("".concat("/api/search","/autocomplete/").concat(t),a);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Se=function(){var e=Object(C.a)(A.a.mark((function e(t){var a;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.get("https://api.discogs.com/database/search?artist=".concat(t.artist,"&release_title=").concat(t.album,"&token=").concat(Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_DISCOGS_TOKEN));case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Le=function(){var e=Object(C.a)(A.a.mark((function e(t){var a,r;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:{Authorization:ke}},e.next=3,m.a.get("/api/top100?list=".concat(t.list,"&start_date=").concat(t.start_date,"&end_date=").concat(t.end_date),a);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),De=function(){var e=Object(C.a)(A.a.mark((function e(t){var a,r;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:{Authorization:ke}},e.next=3,m.a.get("".concat("/api/search","/advanced?kind=").concat(t.kind,"&query=").concat(t.query),a);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),xe=function(){var e=Object(C.a)(A.a.mark((function e(t){var a,r;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:{Authorization:ke}},e.next=3,m.a.put("".concat("/api/search","/advanced"),t,a);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ie={advancedSearch:De,getTop100:Le,getDiscogsData:Se,getTracksForAutocompleteSearch:je,setToken:function(e){ke="bearer ".concat(e)},changeArtistOptions:function(){var e=Object(C.a)(A.a.mark((function e(t){var a,r;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:{Authorization:ke}},e.next=3,m.a.get("".concat("/api/search","/changeartist/").concat(t),a);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),changeAlbumOptions:function(){var e=Object(C.a)(A.a.mark((function e(t){var a,r;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:{Authorization:ke}},e.next=3,m.a.get("".concat("/api/search","/changealbum/").concat(t),a);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),merge:xe},Ne=a(110),Pe=[{key:1,value:"artist_id",label:"Artists"},{key:2,value:"track_id",label:"Tracks"},{key:3,value:"album_id",label:"Albums"}],Ue=function(e){var t=e.onSubmit;return n.a.createElement(P.d,{initialValues:{list:"artist_id",start_date:ce()(Date.now()-6048e5).format("YYYY-MM-DD"),end_date:ce()(new Date).format("YYYY-MM-DD")},onSubmit:t},(function(){return n.a.createElement(Ne.b,{mode:"structured"},n.a.createElement(Ne.c,{name:"list",label:"Get Top 100",options:Pe}),n.a.createElement(Ne.a,{name:"start_date",label:"Starting",dateFormat:"dd.MM.yyyy",placeholder:"dd.mm.yyyy"})," ",n.a.createElement(Ne.a,{name:"end_date",label:"Ending",dateFormat:"dd.MM.yyyy",placeholder:"dd.mm.yyyy"})," ",n.a.createElement(p.a,{type:"submit",color:"green"},"Submit"))}))},Ge=function(e){var t=e.top100;return n.a.createElement(D.a,{striped:!0},n.a.createElement(D.a.Header,null,n.a.createElement(D.a.Row,null,n.a.createElement(D.a.Cell,null,"Artist"),n.a.createElement(D.a.Cell,null,"Play count"))),n.a.createElement(D.a.Body,null,t.map((function(e){return n.a.createElement(D.a.Row,{key:e.track_id},n.a.createElement(D.a.Cell,null,n.a.createElement(u.b,{to:"/artist/".concat(e.artist_id)},e.artist)),n.a.createElement(D.a.Cell,null,e.count))}))))},Me=function(e){var t=e.top100;return n.a.createElement(D.a,{striped:!0},n.a.createElement(D.a.Header,null,n.a.createElement(D.a.Row,null,n.a.createElement(D.a.Cell,null,"Artist"),n.a.createElement(D.a.Cell,null,"Album"),n.a.createElement(D.a.Cell,null,"Play count"))),n.a.createElement(D.a.Body,null,t.map((function(e){return n.a.createElement(D.a.Row,{key:e.track_id},n.a.createElement(D.a.Cell,null,n.a.createElement(u.b,{to:"/artist/".concat(e.artist_id)},e.artist)),n.a.createElement(D.a.Cell,null,n.a.createElement(u.b,{to:"/album/".concat(e.album_id)},e.album)),n.a.createElement(D.a.Cell,null,e.count))}))))},Fe=function(e){var t=e.top100;return n.a.createElement(D.a,{striped:!0},n.a.createElement(D.a.Header,null,n.a.createElement(D.a.Row,null,n.a.createElement(D.a.Cell,null,"Artist"),n.a.createElement(D.a.Cell,null,"Album"),n.a.createElement(D.a.Cell,null,"Track"),n.a.createElement(D.a.Cell,null,"Play count"),n.a.createElement(D.a.Cell,null))),n.a.createElement(D.a.Body,null,t.map((function(e){return n.a.createElement(D.a.Row,{key:e.track_id},n.a.createElement(D.a.Cell,null,n.a.createElement(u.b,{to:"/artist/".concat(e.artist_id)},e.artist)),n.a.createElement(D.a.Cell,null,n.a.createElement(u.b,{to:"/album/".concat(e.album_id)},e.album)),n.a.createElement(D.a.Cell,null,n.a.createElement(u.b,{to:"/track/".concat(e.track_id)},e.track_title)),n.a.createElement(D.a.Cell,null,e.count),n.a.createElement(D.a.Cell,null))}))))},Ye=function(){var e=Object(o.c)((function(e){return e.search})),t=Object(o.b)(),a=function(e){console.log(e);var a,r=Object(y.a)({},e,{end_date:ce()(new Date).format("YYYY-MM-DD")});console.log(r),t((a=r,function(){var e=Object(C.a)(A.a.mark((function e(t){var r;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t({type:"SET_SEARCH_LOADING"}),e.next=4,Ie.getTop100(a);case 4:r=e.sent,t({type:"TOP_100",data:r,query:a}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log("searchActions error getting top100 results",e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}()))};return console.log(e),null===e.top100Query?n.a.createElement(d.a,null,n.a.createElement("h3",{style:{display:"inline"}},"Top 100"),n.a.createElement("p",null,"Get the top 100 most played tracks, albums or artists within a time period."),n.a.createElement(Ue,{onSubmit:a})):e.loading?n.a.createElement(d.a,null,n.a.createElement("h1",null,"Top 100"),n.a.createElement(Ue,{onSubmit:a}),n.a.createElement("div",null,"Loading")):"artist_id"===e.top100Query.list?n.a.createElement(d.a,null,n.a.createElement("h3",{style:{display:"inline"}},"Top 100"),n.a.createElement("p",null,"Get the top 100 most played tracks, albums or artists within a time period."),n.a.createElement(Ue,{onSubmit:a}),n.a.createElement(Ge,{top100:e.top100})):"album_id"===e.top100Query.list?n.a.createElement(d.a,null,n.a.createElement("h3",{style:{display:"inline"}},"Top 100"),n.a.createElement("p",null,"Get the top 100 most played tracks, albums or artists within a time period."),n.a.createElement(Ue,{onSubmit:a}),n.a.createElement(Me,{top100:e.top100})):"track_id"===e.top100Query.list?n.a.createElement(d.a,null,n.a.createElement("h3",{style:{display:"inline"}},"Top 100"),n.a.createElement("p",null,"Get the top 100 most played tracks, albums or artists within a time period."),n.a.createElement(Ue,{onSubmit:a}),n.a.createElement(Fe,{top100:e.top100})):null},Be=null,Ve={getAll:function(){var e=Object(C.a)(A.a.mark((function e(){var t,a;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={headers:{Authorization:Be}},e.next=3,m.a.get("/api/users",t);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),setToken:function(e){Be="bearer ".concat(e)},createUser:function(){var e=Object(C.a)(A.a.mark((function e(t){var a,r;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:{Authorization:Be}},e.next=3,m.a.post("/api/users",t,a);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),updateUser:function(){var e=Object(C.a)(A.a.mark((function e(t){var a,r;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:{Authorization:Be}},e.next=3,m.a.put("".concat("/api/users","/").concat(t.id),t,a);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),deleteUser:function(){var e=Object(C.a)(A.a.mark((function e(t){var a,r;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:{Authorization:Be}},e.next=3,m.a.delete("".concat("/api/users","/").concat(t),a);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()};!function(e){e[e.DJ=1]="DJ",e[e.Staff=2]="Staff",e[e.Admin=3]="Admin"}(me||(me={}));var ze=[{value:me.DJ,label:"DJ"},{value:me.Staff,label:"Staff"},{value:me.Admin,label:"Admin"}],He=[{value:1,label:"Active"},{value:0,label:"Inactive"}],Ke=function(e){var t=e.onSubmit,a=e.onCancel,r=e.user;return n.a.createElement(P.d,{initialValues:{password:"",confirm_password:"",first_name:r.first_name,last_name:r.last_name,email:r.email,level:r.level,status:r.status},onSubmit:t,validate:function(e){console.log(e.level),console.log(e.status);var t={};return e.password!==e.confirm_password&&(t.password="Passwords do not match",t.confirm_password="Passwords do not match"),e.email||(t.email="Field is required"),e.first_name||(t.first_name="Field is required"),e.last_name||(t.last_name="Field is required"),t}},(function(e){var t=e.isValid;return n.a.createElement(P.c,{className:"form ui"},n.a.createElement(P.b,{label:"Password - fill out field only if you wish to change the password",placeholder:"Password",name:"password",type:"password",component:Y}),n.a.createElement(P.b,{label:"Confirm password",placeholder:"Confirm password",name:"confirm_password",type:"password",component:Y}),n.a.createElement(P.b,{label:"First name",placeholder:"First name",name:"first_name",component:M,required:!0}),n.a.createElement(P.b,{label:"Last name",placeholder:"Last name",name:"last_name",component:M}),n.a.createElement(P.b,{label:"Email",placeholder:"Email",name:"email",component:M}),n.a.createElement(G,{label:"Level",name:"level",options:ze}),n.a.createElement(G,{label:"Status",name:"status",options:He}),n.a.createElement(N.a,null,n.a.createElement(N.a.Column,{floated:"left",width:5},n.a.createElement(p.a,{type:"button",onClick:a,color:"red"},"Cancel")),n.a.createElement(N.a.Column,{floated:"right",width:5},n.a.createElement(p.a,{type:"submit",floated:"right",color:"green",disabled:!t},"Update"))))}))},qe=function(e){var t=e.modalOpen,a=e.onClose,r=e.onSubmit,l=e.error,c=e.user;return n.a.createElement(x.a,{open:t,onClose:a,centered:!1,closeIcon:!0},n.a.createElement(x.a.Header,null,"Edit info of user ",c.username),n.a.createElement(x.a.Content,null,l&&n.a.createElement(I.a,{inverted:!0,color:"red"},"Error: ".concat(l)),n.a.createElement(Ke,{user:c,onSubmit:r,onCancel:a})))},Je=function(e){var t,a,l,c=e.user,u=Object(o.b)(),i=Object(r.useState)(!1),s=Object(_.a)(i,2),m=s[0],d=s[1],p=Object(r.useState)(!1),E=Object(_.a)(p,2),f=E[0],b=E[1],v=Object(r.useState)(),g=Object(_.a)(v,2),h=g[0],O=g[1],w=function(){b(!1),O(void 0)};return t=1===c.level?"DJ":2===c.level?"Staff":"Admin",null===c.status||0===c.status?(l="Inactive",a="inactive-user"):1===c.status&&(l="Active",a="active-user"),n.a.createElement(D.a.Row,null,n.a.createElement(D.a.Cell,null,n.a.createElement(qe,{user:c,modalOpen:f,onSubmit:function(e){try{var t=Object(y.a)({},e,{id:c.id});u(function(e){return function(){var t=Object(C.a)(A.a.mark((function t(a){var r;return A.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a({type:"SET_LOADING"}),t.next=4,Ve.updateUser(e);case 4:return t.next=6,Ve.getAll();case 6:r=t.sent,a({type:"UPDATE_USER",data:r}),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),console.log(t.t0);case 13:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(e){return t.apply(this,arguments)}}()}(t)),u(J("".concat(t.first_name," ").concat(t.last_name," updated!"),"success")),console.log("updating user",t),w()}catch(a){console.error(a.response.data),O(a.response.data.error)}},error:h,onClose:w}),n.a.createElement("button",{style:{border:"none",cursor:"pointer",color:"blue"},onClick:function(){return b(!0)}},c.username)),n.a.createElement(D.a.Cell,null,c.first_name," ",c.last_name),n.a.createElement(D.a.Cell,null,c.last_seen),n.a.createElement(D.a.Cell,{className:a},l),n.a.createElement(D.a.Cell,null,t),n.a.createElement(D.a.Cell,null,n.a.createElement(T.a,{color:"red",onClick:function(){return d(!0)},name:"delete"}),n.a.createElement(fe.a,{content:"Are you sure you wish to delete user ".concat(c.username,"?"),open:m,onCancel:function(){d(!1)},onConfirm:function(){var e;d(!1),u((e=c.id,function(){var t=Object(C.a)(A.a.mark((function t(a){return A.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a({type:"SET_LOADING"}),a({type:"DELETE_USER",data:e}),t.next=5,Ve.deleteUser(e);case 5:t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()))},cancelButton:"Cancel delete",confirmButton:"Confirm delete"})))},We=function(e){var t,a=e.login,r=e.users;return 3===(null===(t=a.currentUser)||void 0===t?void 0:t.level)?n.a.createElement(d.a,null,n.a.createElement("div",{style:{marginTop:"1rem",marginBottom:"1rem"}},n.a.createElement("h3",{style:{display:"inline"}},"Users")),n.a.createElement(D.a,{striped:!0},n.a.createElement(D.a.Header,null,n.a.createElement(D.a.Row,null,n.a.createElement(D.a.Cell,null,"Username"),n.a.createElement(D.a.Cell,null,"Name"),n.a.createElement(D.a.Cell,null,"Latest login"),n.a.createElement(D.a.Cell,null,"Status"),n.a.createElement(D.a.Cell,null,"Level"))),n.a.createElement(D.a.Body,null,r.map((function(e){return n.a.createElement(Je,{user:e,key:e.id})}))))):null},Qe=[{value:me.DJ,label:"DJ"},{value:me.Staff,label:"Staff"},{value:me.Admin,label:"Admin"}],Xe=function(e){var t=e.onSubmit,a=e.onCancel;return n.a.createElement(P.d,{initialValues:{username:"",password:"",confirm_password:"",first_name:"",last_name:"",email:"",level:me.DJ},onSubmit:t,validate:function(e){var t="Field is required",a={};return e.username||(a.username=t),e.password||(a.password=t),e.confirm_password||(a.confirm_password=t),e.password!==e.confirm_password&&(a.password="Passwords do not match",a.confirm_password="Passwords do not match"),e.email||(a.email=t),e.first_name||(a.first_name=t),e.last_name||(a.last_name=t),a}},(function(e){var t=e.isValid,r=e.dirty;return n.a.createElement(P.c,{className:"form ui"},n.a.createElement(P.b,{label:"Username",placeholder:"Username",name:"username",component:F}),n.a.createElement(P.b,{label:"Password",placeholder:"Password",name:"password",type:"password",component:B}),n.a.createElement(P.b,{label:"Confirm password",placeholder:"Confirm password",name:"confirm_password",type:"password",component:B}),n.a.createElement(P.b,{label:"First name",placeholder:"First name",name:"first_name",component:F}),n.a.createElement(P.b,{label:"Last name",placeholder:"Last name",name:"last_name",component:F}),n.a.createElement(P.b,{label:"Email",placeholder:"Email",name:"email",component:F}),n.a.createElement(G,{label:"Level",name:"level",options:Qe}),n.a.createElement(N.a,null,n.a.createElement(N.a.Column,{floated:"left",width:5},n.a.createElement(p.a,{type:"button",onClick:a,color:"red"},"Cancel")),n.a.createElement(N.a.Column,{floated:"right",width:5},n.a.createElement(p.a,{type:"submit",floated:"right",color:"green",disabled:!r||!t},"Add"))))}))},Ze=function(e){var t=e.modalOpen,a=e.onClose,r=e.onSubmit,l=e.error;return n.a.createElement(x.a,{open:t,onClose:a,centered:!1,closeIcon:!0},n.a.createElement(x.a.Header,null,"Add a new user"),n.a.createElement(x.a.Content,null,l&&n.a.createElement(I.a,{inverted:!0,color:"red"},"Error: ".concat(l)),n.a.createElement(Xe,{onSubmit:r,onCancel:a})))},$e=function(){var e=Object(o.c)((function(e){return e.user})),t=Object(o.c)((function(e){return e.login})),a=Object(o.b)(),r=n.a.useState(!1),l=Object(_.a)(r,2),c=l[0],u=l[1],i=n.a.useState(),s=Object(_.a)(i,2),m=s[0],E=s[1],f=function(){u(!1),E(void 0)};return n.a.createElement(d.a,null,n.a.createElement(p.a,{floated:"right",color:"green",style:{marginBottom:"0.5rem"},onClick:function(){return u(!0)}},n.a.createElement(T.a,{name:"add"}),"Add a new user"),n.a.createElement(Ze,{modalOpen:c,onSubmit:function(e){try{a((t=e,function(){var e=Object(C.a)(A.a.mark((function e(a){var r;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a({type:"SET_LOADING"}),e.next=4,Ve.createUser(t);case 4:r=e.sent,a({type:"CREATE_USER",data:r}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}())),a(J("User ".concat(e.username," created!"),"success")),f()}catch(r){a(J("Failed to create user!","fail")),console.error(r.response.data),E(r.response.data.error)}var t},error:m,onClose:f}),n.a.createElement(We,{users:e.users,login:t}))},et=a(577),tt={login:function(){var e=Object(C.a)(A.a.mark((function e(t){var a;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.post("/api/login",t);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},at=function(e){"bearer ".concat(e)},rt=function(e){"bearer ".concat(e)},nt=function(e){"bearer ".concat(e)},lt=function(e){"bearer ".concat(e)},ct=function(){var e=Object(o.b)(),t=Object(r.useState)(""),a=Object(_.a)(t,2),l=a[0],c=a[1],u=Object(r.useState)(""),i=Object(_.a)(u,2),s=i[0],m=i[1];return n.a.createElement("div",null,n.a.createElement("h1",null,"RADIO TRACKLIST REPORTING"),n.a.createElement("h3",null,"Log in"),n.a.createElement(U.a,{onSubmit:function(t){t.preventDefault(),e(function(e){return function(){var t=Object(C.a)(A.a.mark((function t(a){var r;return A.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a({type:"SET_LOADING"}),t.next=4,tt.login(e);case 4:r=t.sent,console.log(r),window.localStorage.setItem("loggedUser",JSON.stringify(r)),a({type:"LOGIN",data:r,loading:!1}),t.next=16;break;case 10:t.prev=10,t.t0=t.catch(0),console.log(t.t0),a({type:"SET_NOTIFICATION",data:{message:"wrong username or password",type:"fail"}}),setTimeout((function(){a({type:"CLEAR_NOTIFICATION"})}),3e3);case 16:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(e){return t.apply(this,arguments)}}()}({username:l,password:s}))}},n.a.createElement(U.a.Field,{id:"login-username",label:"username",control:et.a,type:"text",placeholder:"Username...",onChange:function(e){return c(e.target.value.trim())}}),n.a.createElement(U.a.Field,{id:"login-password",label:"password",control:et.a,type:"password",placeholder:"Password...",onChange:function(e){return m(e.target.value.trim())}}),n.a.createElement(p.a,{id:"login-button",color:"green",type:"submit"},"Log in")))},ot=a(584),ut=function(e){var t=e.notification;return"success"===t.type?n.a.createElement("div",{className:"fixedTop"},n.a.createElement(ot.a,{floating:!0,success:!0,header:t.message})):"fail"===t.type?n.a.createElement("div",{className:"fixedTop"},n.a.createElement(ot.a,{floating:!0,negative:!0,header:t.message})):null},it=function(){var e,t,a=Object(o.b)(),l=Object(o.c)((function(e){return e.login})),c=Object(o.c)((function(e){return e.notification}));Object(r.useEffect)((function(){a(function(){var e=Object(C.a)(A.a.mark((function e(t){var a,r;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{t({type:"SET_LOADING"}),(a=window.localStorage.getItem("loggedUser"))&&(r=JSON.parse(a),Ve.setToken(r.token),nt(r.token),Te.setToken(r.token),j.setToken(r.token),Ie.setToken(r.token),lt(r.token),rt(r.token),at(r.token),t({type:"INIT_USER",data:r}))}catch(n){console.log("error initializing user",n)}case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),a(function(){var e=Object(C.a)(A.a.mark((function e(t){var a;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t({type:"SET_LOADING"}),e.next=4,Ve.getAll();case 4:a=e.sent,t({type:"INIT_USER_LIST",data:a}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}()),m.a.get("/ping")}),[null===(e=l.currentUser)||void 0===e?void 0:e.token]);return null===l.currentUser?n.a.createElement(d.a,null,n.a.createElement(ct,null),n.a.createElement(O,null)):null===(null===(t=l.currentUser)||void 0===t?void 0:t.status)?n.a.createElement(d.a,null,n.a.createElement("div",null,"Credentials deactivated. Please contact the administrator."),n.a.createElement(ct,null),n.a.createElement(O,null)):n.a.createElement(u.a,null,n.a.createElement("div",{className:"App"},n.a.createElement(h,null),n.a.createElement(ut,{notification:c}),n.a.createElement("h1",null,"you logged in as ",l.currentUser.username),n.a.createElement(p.a,{onClick:function(){a(function(){var e=Object(C.a)(A.a.mark((function e(t){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window.localStorage.removeItem("loggedUser"),t({type:"LOGOUT"});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}},"logout")),n.a.createElement(i.c,null,n.a.createElement(i.a,{exact:!0,path:"/reports",component:Re}),n.a.createElement(i.a,{exact:!0,path:"/top100",component:Ye}),n.a.createElement(i.a,{exact:!0,path:"/programs",component:re}),n.a.createElement(i.a,{exact:!0,path:"/users",component:$e})),n.a.createElement(O,null))},st=a(81),mt=a(308),dt=a(309),pt=a(35),Et={currentAlbum:null,tracklist:[],loading:!1},ft=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Et,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_ONE_ALBUM":return Object(y.a)({},e,{currentAlbum:t.data,loading:!1});case"GET_TRACKLIST_OF_ALBUM":return Object(y.a)({},e,{tracklist:t.data,loading:!1});case"CLEAR_CURRENT_ALBUM":return Object(y.a)({},e,{currentAlbum:null,tracklist:[],loading:!1});case"ADD_TRACK_TO_ALBUM":return Object(y.a)({},e,{tracklist:[].concat(Object(pt.a)(e.tracklist),[t.data])});case"SET_LOADING":return Object(y.a)({},e,{loading:!0});default:return e}},bt={currentArtist:null,albumList:[],loading:!1},vt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:bt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_ONE_ARTIST":return Object(y.a)({},e,{currentArtist:t.data,loading:!1});case"GET_ALBUM_LIST_BY_ARTIST":return Object(y.a)({},e,{albumList:t.data,loading:!1});case"CLEAR_CURRENT_ARTIST":return Object(y.a)({},e,{currentArtist:null});case"SET_LOADING":return Object(y.a)({},e,{loading:!0});default:return e}},gt={loading:!1,currentUser:null},ht=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:gt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_USER":case"LOGIN":return Object(y.a)({},e,{currentUser:t.data,loading:!1});case"LOGOUT":return gt;case"SET_LOADING":return Object(y.a)({},e,{loading:!0});default:return e}},Ot={message:null,type:null},yt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ot,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_NOTIFICATION":return t.data;case"CLEAR_NOTIFICATION":return Ot;default:return e}},_t={allPrograms:[],activePrograms:[],program:null,loading:!1},Tt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_t,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_ALL_PROGRAMS":return Object(y.a)({},e,{allPrograms:t.data,loading:!1});case"GET_ALL_ACTIVE_PROGRAMS":return Object(y.a)({},e,{activePrograms:t.data,loading:!1});case"GET_ONE_PROGRAM":return Object(y.a)({},e,{program:t.data,loading:!1});case"CREATE_NEW_PROGRAM":return Object(y.a)({},e,{allPrograms:[].concat(Object(pt.a)(e.allPrograms),[t.data]),loading:!1});case"CREATE_NEW_PROGRAM_ON_NEW_REPORT":return Object(y.a)({},e,{activePrograms:[].concat(Object(pt.a)(e.activePrograms),[t.data]),loading:!1});case"UPDATE_PROGRAM":return Object(y.a)({},e,{allPrograms:e.allPrograms.map((function(e){return e.id===t.data.id?t.data:e})),loading:!1});default:return e}},wt={report:[],playlog:[],editTrackId:null,reportDetails:null,newReport:null,loading:!1,checkedForDelete:[],currentTrack:null},At=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:wt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_ONE_REPORT":return Object(y.a)({},e,{report:t.data,loading:!1});case"GET_PLAYLOG_TRACKS":return Object(y.a)({},e,{report:[].concat(Object(pt.a)(e.report),Object(pt.a)(t.report)),playlog:t.playlog,loading:!1});case"GET_REPORT_DETAILS":return Object(y.a)({},e,{reportDetails:t.data,newReport:null,loading:!1});case"ADD_NEW_TRACK":return Object(y.a)({},e,{report:[].concat(Object(pt.a)(e.report),[t.data]),loading:!1});case"ADD_TRACK_TO_REPORT":return Object(y.a)({},e,{report:[].concat(Object(pt.a)(e.report),[t.data])});case"UPDATE_TRACK":return Object(y.a)({},e,{report:e.report.map((function(e){return e.track_id===t.data.track_id?t.data:e})),loading:!1});case"SET_EDIT_TRACK_ID":return Object(y.a)({},e,{editTrackId:t.data});case"GET_ONE_TRACK":return Object(y.a)({},e,{currentTrack:t.data,loading:!1});case"REMOVE_CURRENT_TRACK":return Object(y.a)({},e,{currentTrack:null});case"CLEAR_CURRENT_REPORT":return Object(y.a)({},e,{report:[]});case"CREATE_REPORT":return Object(y.a)({},e,{newReport:t.data,reportDetails:t.data,loading:!1});case"UPDATE_REPORT":return Object(y.a)({},e,{reportDetails:t.data,newReport:null,loading:!1});case"DELETE_TRACK_FROM_REPORT":return Object(y.a)({},e,{report:e.report.filter((function(e){return e.report_track_id!==t.data}))});case"CHECK_FOR_DELETE":return Object(y.a)({},e,{checkedForDelete:[t.data].concat(Object(pt.a)(e.checkedForDelete))});case"UNCHECK_FOR_DELETE":return Object(y.a)({},e,{checkedForDelete:e.checkedForDelete.filter((function(e){return e!==t.data}))});case"CLEAR_CHECKED_FOR_DELETE":return Object(y.a)({},e,{checkedForDelete:[]});case"SET_LOADING":return Object(y.a)({},e,{loading:!0});default:return e}},Ct={reportList:[],inProgress:[],reportListDate:null,reportTransferList:[],lastTransfer:null,loading:!1,filterStatusValue:null,filterUserValue:null,filterByText:"",error:null},Rt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ct,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_ALL_REPORTS_BY_DATE":return Object(y.a)({},e,{reportList:t.data,reportListDate:t.date,loading:!1});case"GET_ALL_IN_PROGRESS":return Object(y.a)({},e,{inProgress:t.data,loading:!1});case"GET_ALL_REPORT_TRANSFERS":return Object(y.a)({},e,{reportTransferList:t.data,loading:!1});case"GENERATE_REPORT_TRANSFER":return Object(y.a)({},e,{lastTransfer:t.data,loading:!1});case"DELETE_REPORT":return Object(y.a)({},e,{reportList:e.reportList.filter((function(e){return e.id!==t.data})),loading:!1});case"FILTER_BY_USER_ID":return Object(y.a)({},e,{filterUserValue:t.data});case"FILTER_BY_STATUS":return Object(y.a)({},e,{filterStatusValue:t.data});case"FILTER_BY_TEXT":return Object(y.a)({},e,{filterByText:t.data});case"SET_LOADING":return Object(y.a)({},e,{loading:!0});default:return e}},kt={top100:[],top100Query:null,advancedResults:[],sortAdvancedResults:null,loading:!1,discogsData:null},jt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:kt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADVANCED_RESULTS":return Object(y.a)({},e,{advancedResults:t.data,loading:!1});case"SORT_ADVANCED_RESULTS":return Object(y.a)({},e,{sortAdvancedResults:t.data});case"TOP_100":return Object(y.a)({},e,{top100:t.data,top100Query:t.query,loading:!1});case"GET_DISCOGS_DATA":return Object(y.a)({},e,{discogsData:t.data});case"CLEAR_DISCOGS_DATA":return Object(y.a)({},e,{discogsData:null});case"SET_SEARCH_LOADING":return Object(y.a)({},e,{loading:!0});case"MERGE_TRACKS":return Object(y.a)({},e,{advancedResults:e.advancedResults.filter((function(e){return e.track_id!==t.data.merge}))});case"MERGE_ARTISTS":var a=t.data.merge,r=t.data.mergeTo,n=t.data.newName,l=e.advancedResults.filter((function(e){return e.artist_id===a})),c=l.map((function(e){return Object(y.a)({},e,{artist_id:r,artist_name:n})})),o=e.advancedResults.filter((function(e){return e.artist_id!==a})),u=[].concat(Object(pt.a)(c),Object(pt.a)(o));return Object(y.a)({},e,{advancedResults:u});default:return e}},St={currentTrack:null,playHistory:[],loading:!1},Lt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:St,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_ONE_TRACK":return Object(y.a)({},e,{currentTrack:t.data,loading:!1});case"GET_ONE_TRACK_HISTORY":return Object(y.a)({},e,{playhistory:t.data,loading:!1});case"CLEAR_CURRENT_TRACK":return Object(y.a)({},e,{playhistory:null,currentTrack:null});case"SET_LOADING":return Object(y.a)({},e,{loading:!0});default:return e}},Dt={users:[],loading:!1},xt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Dt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_USER_LIST":return Object(y.a)({},e,{users:t.data,loading:!1});case"CREATE_USER":return Object(y.a)({},e,{users:[].concat(Object(pt.a)(e.users),[t.data]),loading:!1});case"UPDATE_USER":return Object(y.a)({},e,{users:t.data,loading:!1});case"DELETE_USER":return Object(y.a)({},e,{users:e.users.filter((function(e){return e.id!==t.data})),loading:!1});case"SET_LOADING":return Object(y.a)({},e,{loading:!0});default:return e}},It=Object(st.combineReducers)({album:ft,artist:vt,login:ht,notification:yt,program:Tt,report:At,reportList:Rt,search:jt,track:Lt,user:xt}),Nt=Object(st.createStore)(It,Object(mt.composeWithDevTools)(Object(st.applyMiddleware)(dt.a)));c.a.render(n.a.createElement(o.a,{store:Nt},n.a.createElement(it,null)),document.getElementById("root"))}},[[321,1,2]]]);
//# sourceMappingURL=main.41f3bb18.chunk.js.map