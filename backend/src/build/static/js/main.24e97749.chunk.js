(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{238:function(e,t,a){e.exports=a.p+"static/media/logo.ca9e42db.png"},275:function(e,t,a){e.exports=a(461)},301:function(e,t,a){},461:function(e,t,a){"use strict";a.r(t);var n,r=a(0),l=a.n(r),c=a(46),o=a.n(c),s=a(26),u=(a(283),a(42)),i=a(62),m=a(49),d=a.n(m),p=a(473),f=a(168),E=(a(301),a(478)),b=a(264),v=a(238),h=a.n(v),g=function(e){e.currentUser;return l.a.createElement("div",{style:{marginBottom:"1.5rem"}},l.a.createElement(E.a,{pointing:!0,stackable:!0,inverted:!0},l.a.createElement(E.a.Item,{link:!0},l.a.createElement(u.b,{to:"/"},l.a.createElement(b.a,{alt:"logo",src:h.a,size:"mini"}))),l.a.createElement(E.a.Item,{link:!0},l.a.createElement(u.b,{to:"/reports"},l.a.createElement("h4",null,"REPORTS"))),l.a.createElement(E.a.Item,{link:!0},l.a.createElement(u.b,{to:"/top100"},l.a.createElement("h4",null,"TOP 100"))),l.a.createElement(E.a.Item,{link:!0},l.a.createElement(u.b,{to:"/search"},l.a.createElement("h4",null,"SEARCH"))),l.a.createElement(E.a.Item,{link:!0},l.a.createElement(u.b,{to:"/transfer"},l.a.createElement("h4",null,"TRANSFER FILES"))),l.a.createElement(E.a.Item,{link:!0},l.a.createElement(u.b,{to:"/programs"},l.a.createElement("h4",null,"PROGRAMS"))),l.a.createElement(E.a.Item,{link:!0},l.a.createElement(u.b,{to:"/users"},l.a.createElement("h4",null,"USERS"))),l.a.createElement(E.a.Item,{position:"right"}),l.a.createElement(E.a.Item,null)))},w=function(){var e,t=Object(s.c)((function(e){return e.login}));switch(null===(e=t.currentUser)||void 0===e?void 0:e.level){case 1:case 2:case 3:return l.a.createElement(g,{currentUser:t.currentUser});default:return null}},O=function(){return l.a.createElement("div",{style:{marginTop:"5rem",marginBottom:"2rem",textAlign:"center"}},l.a.createElement("br",null),l.a.createElement("em",null," ","\xa9 ",(new Date).getFullYear()," ",l.a.createElement("a",{href:"https://www.teemukostamo.com",target:"_blank",rel:"noopener noreferrer"}," ","Teemu Kostamo"," ")," "))},y=a(41),S=a(70),_=a(476),C=a(34),I=a(472),T=a(15),j=a.n(T),A=a(23),k=null,U={getAll:function(){var e=Object(A.a)(j.a.mark((function e(){var t,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={headers:{Authorization:k}},e.next=3,d.a.get("/api/users",t);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),setToken:function(e){k="bearer ".concat(e)},createUser:function(){var e=Object(A.a)(j.a.mark((function e(t){var a,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:{Authorization:k}},e.next=3,d.a.post("/api/users",t,a);case 3:return n=e.sent,e.abrupt("return",n.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),updateUser:function(){var e=Object(A.a)(j.a.mark((function e(t){var a,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:{Authorization:k}},e.next=3,d.a.put("".concat("/api/users","/").concat(t.id),t,a);case 3:return n=e.sent,e.abrupt("return",n.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),deleteUser:function(){var e=Object(A.a)(j.a.mark((function e(t){var a,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:{Authorization:k}},e.next=3,d.a.delete("".concat("/api/users","/").concat(t),a);case 3:return n=e.sent,e.abrupt("return",n.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()};!function(e){e[e.DJ=1]="DJ",e[e.Staff=2]="Staff",e[e.Admin=3]="Admin"}(n||(n={}));var x=function(e,t){var a={message:e,type:t};return function(){var e=Object(A.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t({type:"SET_NOTIFICATION",data:a}),setTimeout((function(){t({type:"CLEAR_NOTIFICATION"})}),3e3);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},N=a(129),L=a(480),R=a(479),F=a(17),D=a(474),P=function(e){var t=e.name,a=e.label,n=e.options;return l.a.createElement(D.a.Field,null,l.a.createElement("label",null,a),l.a.createElement(F.b,{as:"select",name:t,className:"ui dropdown"},n.map((function(e){return l.a.createElement("option",{key:e.value,value:e.value},e.label||e.value)}))))},G=function(e){var t=e.field,a=e.label,n=e.placeholder;return l.a.createElement(D.a.Field,null,l.a.createElement("label",null,a),l.a.createElement(F.b,Object.assign({placeholder:n},t,{type:"text"})),l.a.createElement("div",{style:{color:"red"}},l.a.createElement(F.a,{name:t.name})))},J=function(e){var t=e.field,a=e.label,n=e.placeholder;return l.a.createElement(D.a.Field,{required:!0},l.a.createElement("label",null,a),l.a.createElement(F.b,Object.assign({placeholder:n},t,{type:"text"})),l.a.createElement("div",{style:{color:"red"}},l.a.createElement(F.a,{name:t.name})))},B=function(e){var t=e.field,a=e.label,n=e.placeholder;return l.a.createElement(D.a.Field,null,l.a.createElement("label",null,a),l.a.createElement(F.b,Object.assign({placeholder:n},t,{type:"password"})),l.a.createElement("div",{style:{color:"red"}},l.a.createElement(F.a,{name:t.name})))},q=function(e){var t=e.field,a=e.label,n=e.placeholder;return l.a.createElement(D.a.Field,{required:!0},l.a.createElement("label",null,a),l.a.createElement(F.b,Object.assign({placeholder:n},t,{type:"password"})),l.a.createElement("div",{style:{color:"red"}},l.a.createElement(F.a,{name:t.name})))},z=[{value:n.DJ,label:"DJ"},{value:n.Staff,label:"Staff"},{value:n.Admin,label:"Admin"}],H=[{value:1,label:"Active"},{value:0,label:"Inactive"}],V=function(e){var t=e.onSubmit,a=e.onCancel,n=e.user;return l.a.createElement(F.d,{initialValues:{password:"",confirm_password:"",first_name:n.first_name,last_name:n.last_name,email:n.email,level:n.level,status:n.status},onSubmit:t,validate:function(e){var t={};return e.password!==e.confirm_password&&(t.password="Passwords do not match",t.confirm_password="Passwords do not match"),e.email||(t.email="Field is required"),e.first_name||(t.first_name="Field is required"),e.last_name||(t.last_name="Field is required"),t}},(function(e){var t=e.isValid;return l.a.createElement(F.c,{className:"form ui"},l.a.createElement(F.b,{label:"Password - fill out field only if you wish to change the password",placeholder:"Password",name:"password",type:"password",component:B}),l.a.createElement(F.b,{label:"Confirm password",placeholder:"Confirm password",name:"confirm_password",type:"password",component:B}),l.a.createElement(F.b,{label:"First name",placeholder:"First name",name:"first_name",component:G,required:!0}),l.a.createElement(F.b,{label:"Last name",placeholder:"Last name",name:"last_name",component:G}),l.a.createElement(F.b,{label:"Email",placeholder:"Email",name:"email",component:G}),l.a.createElement(P,{label:"Level",name:"level",options:z}),l.a.createElement(P,{label:"Status",name:"status",options:H}),l.a.createElement(R.a,null,l.a.createElement(R.a.Column,{floated:"left",width:5},l.a.createElement(f.a,{type:"button",onClick:a,color:"red"},"Cancel")),l.a.createElement(R.a.Column,{floated:"right",width:5},l.a.createElement(f.a,{type:"submit",floated:"right",color:"green",disabled:!t},"Update"))))}))},K=function(e){var t=e.modalOpen,a=e.onClose,n=e.onSubmit,r=e.error,c=e.user;return l.a.createElement(N.a,{open:t,onClose:a,centered:!1,closeIcon:!0},l.a.createElement(N.a.Header,null,"Edit info of user ",c.username),l.a.createElement(N.a.Content,null,r&&l.a.createElement(L.a,{inverted:!0,color:"red"},"Error: ".concat(r)),l.a.createElement(V,{user:c,onSubmit:n,onCancel:a})))},M=function(e){var t,a,n,c=e.user,o=Object(s.b)(),u=Object(r.useState)(!1),i=Object(y.a)(u,2),m=i[0],d=i[1],p=Object(r.useState)(!1),f=Object(y.a)(p,2),E=f[0],b=f[1],v=Object(r.useState)(),h=Object(y.a)(v,2),g=h[0],w=h[1],O=function(){b(!1),w(void 0)};return t=1===c.level?"DJ":2===c.level?"Staff":"Admin",null===c.status?(n="Inactive",a="inactive-user"):1===c.status&&(n="Active",a="active-user"),l.a.createElement(_.a.Row,null,l.a.createElement(_.a.Cell,null,l.a.createElement(K,{user:c,modalOpen:E,onSubmit:function(e){try{var t=Object(C.a)({},e,{id:c.id});o(function(e){return function(){var t=Object(A.a)(j.a.mark((function t(a){var n;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a({type:"SET_LOADING"}),t.next=4,U.updateUser(e);case 4:return t.next=6,U.getAll();case 6:n=t.sent,a({type:"UPDATE_USER",data:n}),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),console.log(t.t0);case 13:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(e){return t.apply(this,arguments)}}()}(t)),o(x("".concat(t.first_name," ").concat(t.last_name," updated!"),"success")),console.log("updating user",t),O()}catch(a){console.error(a.response.data),w(a.response.data.error)}},error:g,onClose:O}),l.a.createElement("button",{style:{border:"none",cursor:"pointer",color:"blue"},onClick:function(){return b(!0)}},c.username)),l.a.createElement(_.a.Cell,null,c.first_name," ",c.last_name),l.a.createElement(_.a.Cell,null,c.last_seen),l.a.createElement(_.a.Cell,{className:a},n),l.a.createElement(_.a.Cell,null,t),l.a.createElement(_.a.Cell,null,l.a.createElement(S.a,{color:"red",onClick:function(){return d(!0)},name:"delete"}),l.a.createElement(I.a,{content:"Are you sure you wish to delete user ".concat(c.username,"?"),open:m,onCancel:function(){d(!1)},onConfirm:function(){var e;d(!1),o((e=c.id,function(){var t=Object(A.a)(j.a.mark((function t(a){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a({type:"SET_LOADING"}),a({type:"DELETE_USER",data:e}),t.next=5,U.deleteUser(e);case 5:t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()))},cancelButton:"Cancel delete",confirmButton:"Confirm delete"})))},W=function(e){var t,a=e.login,n=e.users;return 3===(null===(t=a.currentUser)||void 0===t?void 0:t.level)?l.a.createElement(p.a,null,l.a.createElement("div",{style:{marginTop:"1rem",marginBottom:"1rem"}},l.a.createElement("h3",{style:{display:"inline"}},"Users")),l.a.createElement(_.a,{striped:!0},l.a.createElement(_.a.Header,null,l.a.createElement(_.a.Row,null,l.a.createElement(_.a.Cell,null,"Username"),l.a.createElement(_.a.Cell,null,"Name"),l.a.createElement(_.a.Cell,null,"Latest login"),l.a.createElement(_.a.Cell,null,"Status"),l.a.createElement(_.a.Cell,null,"Level"))),l.a.createElement(_.a.Body,null,n.map((function(e){return l.a.createElement(M,{user:e,key:e.id})}))))):null},Y=[{value:n.DJ,label:"DJ"},{value:n.Staff,label:"Staff"},{value:n.Admin,label:"Admin"}],Q=function(e){var t=e.onSubmit,a=e.onCancel;return l.a.createElement(F.d,{initialValues:{username:"",password:"",confirm_password:"",first_name:"",last_name:"",email:"",level:n.DJ},onSubmit:t,validate:function(e){var t="Field is required",a={};return e.username||(a.username=t),e.password||(a.password=t),e.confirm_password||(a.confirm_password=t),e.password!==e.confirm_password&&(a.password="Passwords do not match",a.confirm_password="Passwords do not match"),e.email||(a.email=t),e.first_name||(a.first_name=t),e.last_name||(a.last_name=t),a}},(function(e){var t=e.isValid,n=e.dirty;return l.a.createElement(F.c,{className:"form ui"},l.a.createElement(F.b,{label:"Username",placeholder:"Username",name:"username",component:J}),l.a.createElement(F.b,{label:"Password",placeholder:"Password",name:"password",type:"password",component:q}),l.a.createElement(F.b,{label:"Confirm password",placeholder:"Confirm password",name:"confirm_password",type:"password",component:q}),l.a.createElement(F.b,{label:"First name",placeholder:"First name",name:"first_name",component:J}),l.a.createElement(F.b,{label:"Last name",placeholder:"Last name",name:"last_name",component:J}),l.a.createElement(F.b,{label:"Email",placeholder:"Email",name:"email",component:J}),l.a.createElement(P,{label:"Level",name:"level",options:Y}),l.a.createElement(R.a,null,l.a.createElement(R.a.Column,{floated:"left",width:5},l.a.createElement(f.a,{type:"button",onClick:a,color:"red"},"Cancel")),l.a.createElement(R.a.Column,{floated:"right",width:5},l.a.createElement(f.a,{type:"submit",floated:"right",color:"green",disabled:!n||!t},"Add"))))}))},X=function(e){var t=e.modalOpen,a=e.onClose,n=e.onSubmit,r=e.error;return l.a.createElement(N.a,{open:t,onClose:a,centered:!1,closeIcon:!0},l.a.createElement(N.a.Header,null,"Add a new user"),l.a.createElement(N.a.Content,null,r&&l.a.createElement(L.a,{inverted:!0,color:"red"},"Error: ".concat(r)),l.a.createElement(Q,{onSubmit:n,onCancel:a})))},Z=function(){var e=Object(s.c)((function(e){return e.user})),t=Object(s.c)((function(e){return e.login})),a=Object(s.b)(),n=l.a.useState(!1),r=Object(y.a)(n,2),c=r[0],o=r[1],u=l.a.useState(),i=Object(y.a)(u,2),m=i[0],d=i[1],E=function(){o(!1),d(void 0)};return l.a.createElement(p.a,null,l.a.createElement(f.a,{floated:"right",color:"green",style:{marginBottom:"0.5rem"},onClick:function(){return o(!0)}},l.a.createElement(S.a,{name:"add"}),"Add a new user"),l.a.createElement(X,{modalOpen:c,onSubmit:function(e){try{a((t=e,function(){var e=Object(A.a)(j.a.mark((function e(a){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a({type:"SET_LOADING"}),e.next=4,U.createUser(t);case 4:n=e.sent,a({type:"CREATE_USER",data:n}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}())),a(x("User ".concat(e.username," created!"),"success")),E()}catch(n){a(x("Failed to create user!","fail")),console.error(n.response.data),d(n.response.data.error)}var t},error:m,onClose:E}),l.a.createElement(W,{users:e.users,login:t}))},$=a(471),ee={login:function(){var e=Object(A.a)(j.a.mark((function e(t){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.a.post("/api/login",t);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},te=function(){var e=Object(s.b)(),t=Object(r.useState)(""),a=Object(y.a)(t,2),n=a[0],c=a[1],o=Object(r.useState)(""),u=Object(y.a)(o,2),i=u[0],m=u[1];return l.a.createElement("div",null,l.a.createElement("h1",null,"RADIO TRACKLIST REPORTING"),l.a.createElement("h3",null,"Log in"),l.a.createElement(D.a,{onSubmit:function(t){t.preventDefault(),e(function(e){return function(){var t=Object(A.a)(j.a.mark((function t(a){var n;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a({type:"SET_LOADING"}),t.next=4,ee.login(e);case 4:n=t.sent,console.log(n),window.localStorage.setItem("loggedUser",JSON.stringify(n)),a({type:"LOGIN",data:n,loading:!1}),t.next=16;break;case 10:t.prev=10,t.t0=t.catch(0),console.log(t.t0),a({type:"SET_NOTIFICATION",data:{message:"wrong username or password",type:"fail"}}),setTimeout((function(){a({type:"CLEAR_NOTIFICATION"})}),3e3);case 16:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(e){return t.apply(this,arguments)}}()}({username:n,password:i}))}},l.a.createElement(D.a.Field,{id:"login-username",label:"username",control:$.a,type:"text",placeholder:"Username...",onChange:function(e){return c(e.target.value.trim())}}),l.a.createElement(D.a.Field,{id:"login-password",label:"password",control:$.a,type:"password",placeholder:"Password...",onChange:function(e){return m(e.target.value.trim())}}),l.a.createElement(f.a,{id:"login-button",color:"green",type:"submit"},"Log in")))},ae=a(477),ne=function(e){var t=e.notification;return"success"===t.type?l.a.createElement("div",{className:"fixedTop"},l.a.createElement(ae.a,{floating:!0,success:!0,header:t.message})):"fail"===t.type?l.a.createElement("div",{className:"fixedTop"},l.a.createElement(ae.a,{floating:!0,negative:!0,header:t.message})):null},re=function(){var e,t,a=Object(s.b)(),n=Object(s.c)((function(e){return e.login})),c=Object(s.c)((function(e){return e.notification}));console.log("login state",n),Object(r.useEffect)((function(){a(function(){var e=Object(A.a)(j.a.mark((function e(t){var a,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{t({type:"SET_LOADING"}),(a=window.localStorage.getItem("loggedUser"))&&(n=JSON.parse(a),U.setToken(n.token),t({type:"INIT_USER",data:n}))}catch(r){console.log(r)}case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),a(function(){var e=Object(A.a)(j.a.mark((function e(t){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("function ran"),e.prev=1,t({type:"SET_LOADING"}),e.next=5,U.getAll();case 5:a=e.sent,console.log(a),t({type:"INIT_USER_LIST",data:a}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}()),d.a.get("/ping")}),[null===(e=n.currentUser)||void 0===e?void 0:e.token]);return null===n.currentUser?l.a.createElement(p.a,null,l.a.createElement(te,null),l.a.createElement(O,null)):null===(null===(t=n.currentUser)||void 0===t?void 0:t.status)?l.a.createElement(p.a,null,l.a.createElement("div",null,"Credentials deactivated. Please contact the administrator."),l.a.createElement(te,null),l.a.createElement(O,null)):l.a.createElement(u.a,null,l.a.createElement("div",{className:"App"},l.a.createElement(w,null),l.a.createElement(ne,{notification:c}),l.a.createElement("h1",null,"you logged in as",n.currentUser.username),l.a.createElement(f.a,{onClick:function(){a(function(){var e=Object(A.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window.localStorage.removeItem("loggedUser"),t({type:"LOGOUT"});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}},"logout")),l.a.createElement(i.c,null,l.a.createElement(i.a,{exact:!0,path:"/users",component:Z})),l.a.createElement(O,null))},le=a(69),ce=a(262),oe=a(263),se={loading:!1,currentUser:null},ue=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:se,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_USER":case"LOGIN":return Object(C.a)({},e,{currentUser:t.data,loading:!1});case"LOGOUT":return se;case"SET_LOADING":return Object(C.a)({},e,{loading:!0});default:return e}},ie={message:null,type:null},me=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ie,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_NOTIFICATION":return t.data;case"CLEAR_NOTIFICATION":return ie;default:return e}},de=a(265),pe={users:[],loading:!1},fe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_USER_LIST":return Object(C.a)({},e,{users:t.data,loading:!1});case"CREATE_USER":return Object(C.a)({},e,{users:[].concat(Object(de.a)(e.users),[t.data]),loading:!1});case"UPDATE_USER":return Object(C.a)({},e,{users:t.data,loading:!1});case"DELETE_USER":return Object(C.a)({},e,{users:e.users.filter((function(e){return e.id!==t.data})),loading:!1});case"SET_LOADING":return Object(C.a)({},e,{loading:!0});default:return e}},Ee=Object(le.combineReducers)({login:ue,notification:me,user:fe}),be=Object(le.createStore)(Ee,Object(ce.composeWithDevTools)(Object(le.applyMiddleware)(oe.a)));o.a.render(l.a.createElement(s.a,{store:be},l.a.createElement(re,null)),document.getElementById("root"))}},[[275,1,2]]]);
//# sourceMappingURL=main.24e97749.chunk.js.map